<script>
	function meta(name) {
    	var tag = document.querySelector('meta[name=' + name + ']');
    	if (tag != null)
        	return tag.content;
    	return '';
	}

	var roomName = meta('roomName');
	function sendMessage(e) {
    // prevent the page from redirecting
    	e.preventDefault();

    // create a FormData object from our form
    	var fd = new FormData(document.getElementById('messageForm'));

    // send it to the server
    	var req = new XMLHttpRequest();
    	req.open('POST', '/' + meta('roomName'), true);
    	req.send(fd2);
    	//req.open('POST', '/' + meta('roomName') + '/messages', true);
    	//req.send(fd2);
	}
	window.addEventListener('load', function(){
    	var messageForm = document.getElementById('messageForm');
    	messageForm.addEventListener('submit', sendMessage, false);
	}, false);
	var fd1 = new FormData();
	fd1.append('nickname', 'Miley');
	fd1.append('message', 'To my homegirls here with the big butts');

// equivalent to `new FormData(formEl)`
	var fd2 = new FormData();
	fd2.append('nickname', document.getElementById('nicknameField').value);
	fd2.append('message', document.getElementById('messageField').value);
	</script>
